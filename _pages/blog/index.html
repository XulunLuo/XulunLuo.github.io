<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Gasoline Transportation Ally — Top-Down Survival Refueling Game | Xulun Luo </title> <meta name="author" content="Xulun Luo"> <meta name="description" content="A fast-paced top-down survival game where players refuel escaping cars using a custom pressure-sensor controller to keep them from running out of gas and getting caught."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://xulunluo.github.io/_pages/blog/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Xulun Luo </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/filmmaking/">filmmaking </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Gasoline Transportation Ally — Top-Down Survival Refueling Game</h1> <p class="post-description">A fast-paced top-down survival game where players refuel escaping cars using a custom pressure-sensor controller to keep them from running out of gas and getting caught.</p> </header> <article> <h2 style="color:#ff6666;">Game Cycle &amp; Evolution</h2> <ul> <li> <strong>Initial Concept:</strong> Began as a top-down arcade survival prototype built around a custom <em>fuel-gun</em> controller. The goal was to keep cars alive by refueling them before they ran out of gas and descended toward capture by police cars at the bottom of the screen.</li> <li> <strong>Core Loop:</strong> Four getaway cars leak fuel as they descend through five survival levels. The player, controlling a <em>flying cat-shaped refueling gun</em>, must continuously manage which car to fuel next while avoiding overfill explosions.</li> <li> <strong>Mechanics:</strong> <ul> <li>Cars descend at rates tied to their current gasoline level.</li> <li>Refueling pauses descent and restores altitude.</li> <li>Overfilling causes an explosion that transfers fuel to adjacent lanes — a designed <em>risk-reward</em> moment.</li> </ul> </li> <li> <strong>Early Build (Interim):</strong> <ul> <li>The physical controller and art direction drew attention, but unclear fuel logic, missing explosion feedback, and controller calibration issues caused confusion.</li> <li>Players often scored <strong>zero points</strong>, revealing the need for a more forgiving scoring curve and stronger feedback cues.</li> </ul> </li> <li> <strong>Iteration &amp; Refinement:</strong> <ul> <li>Rebuilt the gasoline system with clearer color states and audio feedback.</li> <li>Calibrated the controller for smoother aiming and consistent pressure response.</li> <li>Added <strong>tutorial sequencing</strong> and <strong>dialogue-based onboarding</strong> to introduce one car before scaling to five.</li> <li>Integrated <strong>timer and scoring UI</strong> to improve pacing and give a sense of progress.</li> </ul> </li> <li> <strong>Final Build:</strong> <ul> <li>Achieved a more balanced rhythm where players could recognize and plan refueling cycles.</li> <li>Visual feedback and difficulty tuning made the experience more readable and engaging.</li> <li>Remaining issues included an “optimal” mid-lane strategy, a plateaued late-game interest curve, and limited escalation in the final minute.</li> </ul> </li> <li> <strong>Goal:</strong> Survive the countdown with at least one car remaining — a test of focus, timing, and resource management under pressure.</li> </ul> <hr> <h2 style="color:#66ccff;">My Role</h2> <ul> <li> <strong>Programmer &amp; Systems Designer:</strong> <ul> <li>Architected the full gameplay loop in C# and Unity.</li> <li>Implemented real-time <strong>gasoline management</strong>, <strong>collision logic</strong>, and <strong>car state machines</strong>.</li> <li>Designed and coded <strong>controller input handling</strong> (WASD + custom analog trigger via Xbox Adaptive Controller).</li> <li>Wrote <strong>tutorial logic</strong> using coroutine-based sequences for progressive learning.</li> <li>Built <strong>UI feedback systems</strong> (fuel bars, color transitions, timer, win/lose panels).</li> <li>Collaborated on gameplay feel — adjusting descent intervals, explosion timings, and police animations for balance and flow.</li> </ul> </li> </ul> <hr> <h2 style="color:#33cc99;">System Overview</h2> <ul> <li> <strong>Top-Down Game Board:</strong> <ul> <li>4 vertical lanes (columns) × 5 horizontal survival levels (rows).</li> <li>Cars start at Level 4 and descend as gas drains.</li> <li>Police cars patrol Level 0 — the capture line.</li> </ul> </li> <li> <strong>Class Architecture:</strong> <ul> <li> <strong><code class="language-plaintext highlighter-rouge">Gasoline</code></strong> – Manages refuel/decay rate, color feedback, explosion detection.</li> <li> <strong><code class="language-plaintext highlighter-rouge">Car</code></strong> – Controls survival level, movement interpolation, and inter-lane fuel transfer.</li> <li> <strong><code class="language-plaintext highlighter-rouge">GameManager</code></strong> – Handles game timer, scoring, win/lose transitions, and scene management.</li> <li> <strong><code class="language-plaintext highlighter-rouge">ControllerInput</code></strong> – Reads joystick and analog trigger input for crosshair aiming and refueling control.</li> <li> <strong><code class="language-plaintext highlighter-rouge">TrainingManager</code></strong> – Walks new players through mechanics step by step using coroutine-based storytelling.</li> </ul> </li> <li> <strong>Gameplay Logic Flow:</strong><br> <code class="language-plaintext highlighter-rouge">ControllerInput → Gasoline → Car → GameManager → UI</code> </li> <li> <strong>Simulation Rules:</strong> <ul> <li>Gas level directly maps to descent interval (<code class="language-plaintext highlighter-rouge">Mathf.Infinity</code> at 5 gas, 1 sec at critical).</li> <li>Explosion adds +4 fuel to adjacent lanes.</li> <li>Game ends when timer = 0 (Win) or all cars caught/exploded (Lose).</li> </ul> </li> </ul> <h3 class="mt-3">Platform Abstraction (Keyboard ↔ Xbox Adaptive)</h3> <div class="rounded p-3 my-2" style="background:#f8f9fa;border-left:4px solid #33cc99;"> ```csharp // System-facing interface (gameplay depends on this, not hardware) public interface IRefuelInput { float Pressure { get; } // 0..1 analog fueling Vector2 AimAxis { get; } // world-space aim for crosshair } // Desktop adapter (keyboard) public sealed class KeyboardRefuelInput : IRefuelInput { public float Pressure =&gt; Input.GetKey(KeyCode.Space) ? 1f : 0f; public Vector2 AimAxis =&gt; new Vector2(Input.GetAxisRaw("Horizontal"), Input.GetAxisRaw("Vertical")); } // Xbox Adaptive Controller adapter public sealed class XACRefuelInput : IRefuelInput { public float Pressure =&gt; Mathf.Clamp01(Input.GetAxis("GasAddInput")); public Vector2 AimAxis =&gt; new Vector2(Input.GetAxisRaw("XAC_H"), Input.GetAxisRaw("XAC_V")); } ``` <p class="small text-muted mb-0">Swap adapters to change platforms—no gameplay code changes.</p> </div> <h3 class="mt-3">Movement Policy (ScriptableObject tuning)</h3> <div class="rounded p-3 my-2" style="background:#f8f9fa;border-left:4px solid #66ccff;"> ```csharp [CreateAssetMenu(menuName = "GTA/VerticalMovementPolicy")] public class VerticalMovementPolicy : ScriptableObject { // index by gas band 1..7 (clamped) public float[] bandIntervals = { 1f, 2.5f, 3f, 3.5f, Mathf.Infinity, 0.7f, 1.0f }; public float IntervalForBand(int band) =&gt; band &lt;= 0 ? 1f : band &gt; bandIntervals.Length ? bandIntervals[^1] : bandIntervals[band-1]; } ``` <p class="small text-muted mb-0">Design-driven difficulty: adjust intervals in an asset, no code changes.</p> </div> <hr> <h2 style="color:#9966ff;">Technical Challenges &amp; Solutions</h2> <ul> <li> <strong>Challenge 1 – Controller balance and motion smoothness</strong> <ul> <li> <em>Initial issue:</em> The custom refuel gun, built from PVC tubes, was unbalanced and stiff. We first added heavy items like bullets and weights inside to simulate pressure feedback, but the motion wasn’t smooth and caused fatigue.</li> <li> <em>Solution:</em> Through iterative prototyping, we discovered that the <strong>front–back and left–right lever arms</strong> required different torque balances because players move differently along each axis. We shortened the forward lever, extended the lateral one, and wrapped internal weights with <strong>foam sleeves</strong> to create damping inside the pipe.</li> <li> <em>Outcome:</em> The gun achieved a smoother swing motion and more natural return force, improving both control precision and player comfort.</li> </ul> </li> </ul> <div class="row"> <div class="col-sm mt-3"> <figure> <picture> <img src="/assets/img/projects/gasoline/Initial_Gun.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Initial fuel gun prototype — unbalanced and stiff, using ad-hoc weights inside PVC tube" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3"> <figure> <picture> <img src="/assets/img/projects/gasoline/Final_Gun.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Final balanced gun — adjusted lever arms and foam-damped weights for smoother control" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h3 class="mt-3">Gasoline System (evented, time-driven)</h3> <div class="rounded p-3 my-2" style="background:#f8f9fa;border-left:4px solid #9966ff;"> ```csharp // Gasoline System (evented, time-driven) public interface ITimeSource { float DeltaTime { get; } } public sealed class UnityTime : ITimeSource { public float DeltaTime =&gt; Time.deltaTime; } public sealed class GasolineSystem { public int Gas { get; private set; } public bool Exploded { get; private set; } public event System.Action OnGasChanged; // UI bars / SFX public event System.Action OnExploded; // adjacent-lane refuel private readonly ITimeSource _time; private float _decayTimer = 0f; private float _decayInterval = 3f; private float _refuelAccum = 0f; public GasolineSystem(int startGas, ITimeSource time) { Gas = startGas; _time = time; } public void Tick() { if (Exploded) return; _decayTimer += _time.DeltaTime; if (_decayTimer &gt;= _decayInterval) { AddGas(-1); _decayTimer = 0f; } } public void Refuel(float pressure, float ratePerSecond = 6f) { if (Exploded) return; _refuelAccum += pressure * ratePerSecond * _time.DeltaTime; if (_refuelAccum &gt;= 1f) { AddGas(1); _refuelAccum = 0f; } } private void AddGas(int delta) { Gas = Mathf.Clamp(Gas + delta, 0, 14); OnGasChanged?.Invoke(Gas); if (Gas &gt;= 14 &amp;&amp; !Exploded) { Exploded = true; OnExploded?.Invoke(); } } public void SetDecayInterval(float seconds) =&gt; _decayInterval = Mathf.Max(0.3f, seconds); } ``` <p class="small text-muted mb-0">Event-driven architecture allows UI and audio systems to react to gas changes without tight coupling.</p> </div> <ul> <li> <p><strong>Challenge 2 – Multi-car state synchronization</strong></p> <ul> <li> <em>Issue:</em> Cars updated asynchronously, causing desynchronized descent and explosion timing.</li> <li> <em>Solution:</em> Centralized all time references to <code class="language-plaintext highlighter-rouge">Time.deltaTime</code> and unified car updates under the <code class="language-plaintext highlighter-rouge">GameManager</code>’s master clock.</li> <li> <em>Outcome:</em> Stable multi-vehicle behavior across all lanes.</li> </ul> </li> <li> <p><strong>Challenge 3 – Chain reaction control</strong></p> <ul> <li> <em>Issue:</em> Explosions could loop infinitely as cars repeatedly refueled each other.</li> <li> <em>Solution:</em> Added adjacency checks (<code class="language-plaintext highlighter-rouge">Mathf.Abs(carID - otherID) == 1</code>) and per-frame delay buffers.</li> <li> <em>Outcome:</em> Predictable chain explosions without logic overflow.</li> </ul> </li> <li> <p><strong>Challenge 4 – Input calibration and readability</strong></p> <ul> <li> <em>Issue:</em> The analog trigger signal from the adaptive controller fluctuated unpredictably.</li> <li> <em>Solution:</em> Smoothed the <code class="language-plaintext highlighter-rouge">Input.GetAxis("GasAddInput")</code> values and applied clamping to remove noise while preserving pressure sensitivity.</li> <li> <em>Outcome:</em> Consistent refueling rate that felt responsive to both gentle and full-pressure inputs.</li> </ul> </li> <li> <p><strong>Challenge 5 – Visual and onboarding clarity</strong></p> <ul> <li> <em>Issue:</em> Early testers couldn’t interpret fuel or explosion feedback.</li> <li> <em>Solution:</em> Added color-coded fuel bars (green–yellow–red), glow warnings, and a step-by-step tutorial sequence using coroutine-driven dialogues.</li> <li> <em>Outcome:</em> Players learned faster, and late-stage playtests showed clear comprehension within one round.</li> </ul> </li> </ul> <hr> <h2 style="color:#ffaa33;">Results</h2> <ul> <li> <strong>Functional 5-car survival system</strong> with synchronized descent and explosion feedback.</li> <li> <strong>Interactive training mode</strong> guiding new players through each mechanic.</li> <li> <strong>Stable, modular architecture</strong> spanning 9 scripts and &gt;3,000 lines of code, allowing rapid iteration.</li> <li> <strong>Smooth controller experience</strong> verified with both keyboard and adaptive hardware input.</li> <li> <strong>Accessible, high-energy gameplay</strong> praised during ETC demo sessions for its chaos-management and humor.</li> <li> <strong>Next steps:</strong> balance difficulty scaling and introduce leaderboard persistence via Unity PlayerPrefs or external JSON save.</li> </ul> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Xulun Luo. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>